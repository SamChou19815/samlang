/* eslint-disable */
module.exports = {
name: "@yarnpkg/plugin-generate-workspaces-json",
factory: function (require) {
var plugin;plugin=(()=>{"use strict";var n={153:(n,e,r)=>{r.r(e),r.d(e,{default:()=>c});const o=require("fs"),t=require("path"),a='\n    runs-on: ubuntu-latest\n    steps:\n      - uses: actions/checkout@v2\n        with:\n          fetch-depth: "2"\n      - uses: actions/setup-node@v2-beta\n      - uses: actions/cache@v2\n        with:\n          path: ".yarn/cache\\n.pnp.js"\n          key: "yarn-berry-${{ hashFiles(\'**/yarn.lock\') }}"\n          restore-keys: "yarn-berry-"\n      - name: Yarn Install\n        run: yarn install --immutable',s=n=>[[".github/workflows/generated-general.yml",`# @generated\n\nname: General\non:\n  push:\n    branches:\n      - master\n  pull_request:\n\njobs:\n  lint:${a}\n      - name: Format Check\n        run: yarn format:check\n      - name: Lint\n        run: yarn lint\n  build:${a}\n      - name: Compile\n        run: yarn compile\n  validate:${a}\n      - name: Check changed\n        run: if [[ \`git status --porcelain\` ]]; then exit 1; fi\n  test:${a}\n      - name: Test\n        run: yarn test\n`],...n.topologicallyOrdered.filter(e=>((n,e,r)=>{var a,s;const i=n.information[e];if(null==i)throw new Error;return null!=(null===(s=null===(a=JSON.parse((0,o.readFileSync)((0,t.join)(i.workspaceLocation,"package.json")).toString()))||void 0===a?void 0:a.scripts)||void 0===s?void 0:s[r])})(n,e,"deploy")).map(e=>{var r,o;return[`.github/workflows/generated-${"cd-"+e}.yml`,`# @generated\n\nname: CD ${e}\non:\n  push:\n    paths:${(null!==(o=null===(r=n.information[e])||void 0===r?void 0:r.dependencyChain)&&void 0!==o?o:[]).map(e=>{var r;return`\n      - '${null===(r=n.information[e])||void 0===r?void 0:r.workspaceLocation}/**'`}).join("")}\n      - 'configuration/**'\n      - '.github/workflows/generated-*-${e}.yml'\n    branches:\n      - master\n\njobs:\n  deploy:${a}\n      - name: Build\n        run: yarn workspace ${e} build\n      - name: Install Firebase\n        run: sudo npm install -g firebase-tools\n      - name: Deploy\n        run: FIREBASE_TOKEN=\${{ secrets.FIREBASE_TOKEN }} yarn workspace ${e} deploy\n`]})],i=(0,t.join)(".github","workflows"),l=async n=>{(0,o.existsSync)(i)&&(0,o.readdirSync)(i).forEach(n=>{n.startsWith("generated-")&&(0,o.unlinkSync)((0,t.join)(i,n))}),(0,o.mkdirSync)(i,{recursive:!0}),s(n).forEach(([n,e])=>{(0,o.writeFileSync)(n,e)})},c={hooks:{afterAllInstalled:()=>{const n=r(633).Z;(0,o.writeFileSync)("workspaces.json",JSON.stringify(n,void 0,2)+"\n"),l(n)}},commands:[]}},633:(n,e,r)=>{r.d(e,{Z:()=>s});const o=require("child_process"),t=(()=>{const n=new Map,e=`[${(0,o.spawnSync)("yarn",["workspaces","list","-v","--json"]).stdout.toString().trim().split("\n").join(",")}]`,r=JSON.parse(e),t={};return r.forEach(({name:n,location:e})=>{null!=n&&(t[e]=n)}),r.forEach(({name:e,location:r,workspaceDependencies:o})=>{null!=e&&n.set(e,{workspaceLocation:r,dependencies:o.map(n=>{const e=t[n];if(null==e)throw new Error(`Bad dependency of ${e}: ${n}`);return e})})}),n})(),a=n=>{const e=[],r=[],o=new Set,a=new Set,s=i=>{var l;if(a.has(i)){if(!o.has(i))return;r.push(i);const n=r.indexOf(i),e=r.slice(n,r.length).join(" -> ");throw new Error("Cyclic dependency detected: "+e)}const c=null===(l=t.get(i))||void 0===l?void 0:l.dependencies;if(null==c)throw new Error(`Workspace ${n} is not found!`);a.add(i),r.push(i),o.add(i),c.forEach(s),o.delete(i),r.pop(),e.push(i)};return s(n),e},s={__type__:"@generated",information:Object.fromEntries(Array.from(t.entries()).map(([n,{dependencies:e,...r}])=>[n,{...r,dependencyChain:a(n)}]).sort(([n],[e])=>n.localeCompare(e))),topologicallyOrdered:(()=>{const n=[],e=new Set;return Array.from(t.keys()).forEach(r=>{a(r).forEach(r=>{e.has(r)||(n.push(r),e.add(r))})}),n})()}}},e={};function r(o){if(e[o])return e[o].exports;var t=e[o]={exports:{}};return n[o](t,t.exports,r),t.exports}return r.d=(n,e)=>{for(var o in e)r.o(e,o)&&!r.o(n,o)&&Object.defineProperty(n,o,{enumerable:!0,get:e[o]})},r.o=(n,e)=>Object.prototype.hasOwnProperty.call(n,e),r.r=n=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(n,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(n,"__esModule",{value:!0})},r(153)})();
return plugin;
}
};