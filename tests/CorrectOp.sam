class CorrectOp {
  function crash(a: Str, b: Str): unit = {
    Process.println("different:");
    Process.println("a:");
    Process.println(a);
    Process.println("b:");
    Process.println(b);
    Process.panic<unit>("crash!");
  }

  function checkInt(a: int, b: int): unit =
    if a == b {  } else { CorrectOp.crash(Str.fromInt(a), Str.fromInt(b)) }

  function boolToString(b: bool): Str = if b { "true" } else { "false" }

  function checkBool(a: bool, b: bool): unit =
    if a == b {  } else { CorrectOp.crash(CorrectOp.boolToString(a), CorrectOp.boolToString(b)) }

  function checkAll(): unit = {
    CorrectOp.checkInt(42, 21 * 2);
    CorrectOp.checkInt(42, 84 / 2);
    CorrectOp.checkInt(42, 91 % 49);
    CorrectOp.checkInt(42, 20 + 22);
    CorrectOp.checkInt(42, 50 - 8);
    CorrectOp.checkBool(false, false);
    CorrectOp.checkBool(true, true);
    CorrectOp.checkBool(false, false && false);
    CorrectOp.checkBool(false, true && false);
    CorrectOp.checkBool(false, false && true);
    CorrectOp.checkBool(true, true && true);
    CorrectOp.checkBool(false, false || false);
    CorrectOp.checkBool(true, true || false);
    CorrectOp.checkBool(true, false || true);
    CorrectOp.checkBool(true, true || true);
    CorrectOp.checkBool(true, 42 < 50);
    CorrectOp.checkBool(false, 42 > 42);
    CorrectOp.checkBool(false, 42 > 50);
    CorrectOp.checkBool(true, 42 <= 42);
    CorrectOp.checkBool(true, 42 <= 43);
    CorrectOp.checkBool(false, 42 <= 41);
    CorrectOp.checkBool(true, 50 > 42);
    CorrectOp.checkBool(false, 42 < 42);
    CorrectOp.checkBool(false, 50 < 42);
    CorrectOp.checkBool(true, 42 >= 42);
    CorrectOp.checkBool(true, 43 >= 42);
    CorrectOp.checkBool(false, 41 >= 42);
    CorrectOp.checkBool(true, 1 == 1);
    CorrectOp.checkBool(false, 1 == 2);
    CorrectOp.checkBool(false, 1 != 1);
    CorrectOp.checkBool(true, 1 != 2);
    CorrectOp.checkBool(true, true == true);
    CorrectOp.checkBool(false, true == false);
    CorrectOp.checkBool(false, true != true);
    CorrectOp.checkBool(true, true != false);
    let c = 21;
    CorrectOp.checkInt(-42, -(c * 2));
    // prevent constant folding!
    CorrectOp.checkBool(true, !false);
    CorrectOp.checkBool(false, !true);
  }

  function run(): unit = {
    CorrectOp.checkAll();
  }
}
